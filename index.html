<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Instagram Unfollow AracÄ± - Pro</title>
    <style>
        body { font-family: -apple-system, sans-serif; background: #fafafa; display: flex; justify-content: center; padding: 20px; margin: 0; }
        .container { background: white; width: 100%; max-width: 550px; padding: 30px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); border: 1px solid #dbdbdb; }
        h1 { text-align: center; background: linear-gradient(45deg, #f09433, #dc2743, #bc1888); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 25px; }
        .drop-zone { border: 2px dashed #0095f6; border-radius: 15px; padding: 40px; text-align: center; cursor: pointer; background: #f0f9ff; transition: 0.3s; margin-bottom: 20px; color: #0095f6; font-weight: bold; }
        .summary-card { background: linear-gradient(45deg, #f09433, #dc2743, #bc1888); color: white; padding: 20px; border-radius: 15px; text-align: center; margin-bottom: 20px; display: none; font-weight: bold; font-size: 20px; }
        .search-box { width: 100%; padding: 12px; border: 1px solid #dbdbdb; border-radius: 10px; margin-bottom: 15px; box-sizing: border-box; display: none; }
        
        /* GeliÅŸtirilmiÅŸ Buton TasarÄ±mÄ± */
        .user-list { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; max-height: 450px; overflow-y: auto; padding: 5px; }
        .user-wrapper { display: inline-flex; align-items: center; background: #0095f6; border-radius: 20px; transition: 0.3s; overflow: hidden; }
        .user-link { color: white; text-decoration: none; padding: 8px 15px; font-size: 13px; font-weight: 600; display: block; }
        .user-link:hover { background: #0074cc; }
        
        /* KapatÄ±lmÄ±ÅŸ Hesaplar Ä°Ã§in KaldÄ±rma Butonu */
        .remove-btn { color: #ffffff; cursor: pointer; font-weight: bold; font-size: 16px; padding: 8px 10px; background: rgba(0,0,0,0.1); border-left: 1px solid rgba(255,255,255,0.2); transition: 0.2s; }
        .remove-btn:hover { background: #ed4956; color: white; }
        
        /* TÄ±klanan Hesap Stili */
        .user-wrapper.visited { background: #dbdbdb !important; opacity: 0.6; }
        .user-wrapper.visited .user-link { text-decoration: line-through; color: #8e8e8e; }
        .user-wrapper.visited .remove-btn { background: transparent; color: #8e8e8e; }

        .footer { font-size: 11px; color: #999; text-align: center; margin-top: 25px; border-top: 1px solid #eee; padding-top: 15px; line-height: 1.5; }
    </style>
</head>
<body>

<div class="container">
    <h1>Unfollow Bulucu Pro</h1>
    
    <div class="drop-zone" id="dropZone" onclick="document.getElementById('fileInput').click()">
        Followers ve Following dosyalarÄ±nÄ± buraya bÄ±rakÄ±n
        <input type="file" id="fileInput" multiple accept=".json" style="display: none;">
    </div>

    <div id="summary" class="summary-card"></div>
    <input type="text" id="search" class="search-box" placeholder="Listede kullanÄ±cÄ± adÄ± ara..." onkeyup="filterUsers()">
    <div id="results" class="user-list"></div>

    <div class="footer">
        Åžifre istenmez, veriler tarayÄ±cÄ±da gÃ¼venle iÅŸlenir. <br>
        <strong>KullanÄ±m:</strong> Ä°simlere tÄ±kla profile git. KapalÄ±/silinmiÅŸ hesaplarÄ± yanÄ±ndaki "Ã—" butonuna basarak temizle. <br>
        Limit: Saatte 20-30 kiÅŸiden fazla iÅŸlem yapma.
    </div>
</div>

<script>
    const fileInput = document.getElementById('fileInput');

    fileInput.addEventListener('change', async (e) => {
        const files = Array.from(e.target.files);
        let followers = new Set();
        let following = new Set();

        for (let file of files) {
            const text = await file.text();
            let data;
            try { data = JSON.parse(text); } catch(err) { continue; }

            const names = deepExtract(data);
            if (file.name.toLowerCase().includes('follower')) {
                names.forEach(n => followers.add(n));
            } else if (file.name.toLowerCase().includes('following')) {
                names.forEach(n => following.add(n));
            }
        }

        const unfollowers = [...following].filter(u => !followers.has(u)).sort();
        render(unfollowers);
    });

    function deepExtract(obj) {
        let results = [];
        function traverse(val) {
            if (!val || typeof val !== 'object') return;
            if (val.value && typeof val.value === 'string' && (val.href || val.timestamp)) {
                results.push(val.value);
            } else if (val.title && typeof val.title === 'string' && val.string_list_data) {
                results.push(val.title);
            }
            Object.values(val).forEach(traverse);
        }
        traverse(obj);
        return results;
    }

    function render(list) {
        const summary = document.getElementById('summary');
        const search = document.getElementById('search');
        const results = document.getElementById('results');

        summary.style.display = "block";
        search.style.display = "block";
        summary.innerText = `ðŸ•µï¸â€â™‚ï¸ ${list.length} kiÅŸi seni takip etmiyor!`;

        results.innerHTML = list.map(u => `
            <div class="user-wrapper" id="wrap-${u}">
                <a href="https://instagram.com/${u}" target="_blank" class="user-link" onclick="markVisited('${u}')">@${u}</a>
                <span class="remove-btn" onclick="removeUser('${u}')" title="Listeden kaldÄ±r">Ã—</span>
            </div>
        `).join('');
    }

    function markVisited(id) {
        document.getElementById('wrap-' + id).classList.add('visited');
    }

    function removeUser(id) {
        const element = document.getElementById('wrap-' + id);
        element.style.transform = "scale(0.5)";
        element.style.opacity = "0";
        setTimeout(() => {
            element.remove();
            updateCount();
        }, 300);
    }

    function updateCount() {
        const remaining = document.querySelectorAll('.user-wrapper').length;
        document.getElementById('summary').innerText = `ðŸ•µï¸â€â™‚ï¸ ${remaining} kiÅŸi seni takip etmiyor!`;
    }

    function filterUsers() {
        const term = document.getElementById('search').value.toLowerCase();
        document.querySelectorAll('.user-wrapper').forEach(wrap => {
            const username = wrap.id.replace('wrap-', '').toLowerCase();
            wrap.style.display = username.includes(term) ? "inline-flex" : "none";
        });
    }
</script>

</body>
</html>
